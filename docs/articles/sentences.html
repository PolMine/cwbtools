<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How to add a sentence annotation to an indexed corpus • cwbtools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="How to add a sentence annotation to an indexed corpus">
<meta property="og:description" content="cwbtools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cwbtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/europarl.html">Creating a Corpus Data Package: Wrapping Europarl</a>
    </li>
    <li>
      <a href="../articles/sentences.html">How to add a sentence annotation to an indexed corpus</a>
    </li>
    <li>
      <a href="../articles/vignette.html">Introducing 'cwbtools'</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/PolMine/cwbtools/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>How to add a sentence annotation to an indexed corpus</h1>
                        <h4 class="author">Andreas Blätte (<a href="mailto:andreas.blaette@uni-due.de" class="email">andreas.blaette@uni-due.de</a>)</h4>
            
            <h4 class="date">2020-06-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/PolMine/cwbtools/blob/master/vignettes/sentences.Rmd"><code>vignettes/sentences.Rmd</code></a></small>
      <div class="hidden name"><code>sentences.Rmd</code></div>

    </div>

    
    
<div id="about" class="section level2">
<h2 class="hasAnchor">
<a href="#about" class="anchor"></a>About</h2>
<p>There are many reasons why encoding an annotation of sentences as a structural attribute may be valuable. This vignette offers a basic recipe for a corpus that already includes a part-of-speech annotation. The GermaParl corpus serves as an example.</p>
</div>
<div id="getting-started" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h2>
<p>In addition to the cwbtools package, we use some functionality of the polmineR package.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">cwbtools</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">polmineR</span>)
<span class="fu"><a href="https://rdrr.io/pkg/polmineR/man/use.html">use</a></span>(<span class="st">"polmineR"</span>)</pre></body></html></div>
<p>Adding an s-attribute is not a risky operation. The attribute can be removed again. Nevertheless, we use a temporary copy here.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"># Yet to be written</pre></body></html></div>
</div>
<div id="recipe" class="section level2">
<h2 class="hasAnchor">
<a href="#recipe" class="anchor"></a>Recipe</h2>
<p>We generate the data for the sentence annotation from the part-of-speech annotation that is already present.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">pos</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/polmineR/man/corpus-class.html">corpus</a></span>(<span class="st">"GERMAPARL"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/polmineR/man/get_token_stream-method.html">get_token_stream</a></span>(<span class="kw">p_attribute</span> <span class="kw">=</span> <span class="st">"pos"</span>)

<span class="no">sentence_end</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span>(<span class="st">"\\$\\."</span>, <span class="no">pos</span>)

<span class="no">cpos_sentences</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span>(
  <span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq.int</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="fl">0L</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">pos</span>) - <span class="fl">1L</span>),
  <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0L</span>, <span class="no">sentence_end</span>),
  <span class="kw">include.lowest</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
  <span class="kw">right</span> <span class="kw">=</span> <span class="fl">FALSE</span>
)

<span class="no">df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/polmineR/man/partition_class.html">split</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">cpos</span>, <span class="kw">f</span> <span class="kw">=</span> <span class="no">cpos_sentences</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(<span class="kw">function</span>(<span class="no">cpos</span>) <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">cpos</span>[<span class="fl">1L</span>], <span class="no">cpos</span>[<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">cpos</span>)])) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2L</span>, <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>()

<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">df</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"cpos_left"</span>, <span class="st">"cpos_right"</span>)
<span class="no">df</span><span class="kw">[[</span><span class="st">"sentence"</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq.int</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="fl">0L</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="no">df</span>) - <span class="fl">1L</span>)</pre></body></html></div>
<p>So let us see what we have …</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">df</span>)</pre></body></html></div>
<p>And this is how the new annotation layer is written back to the corpus.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="../reference/s_attribute.html">s_attribute_encode</a></span>(
  <span class="kw">values</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="no">df</span><span class="kw">[[</span><span class="st">"sentence"</span>]]),
  <span class="kw">data_dir</span> <span class="kw">=</span> <span class="kw pkg">cwbtools</span><span class="kw ns">::</span><span class="fu"><a href="../reference/registry_file.html">registry_file_parse</a></span>(<span class="kw">corpus</span> <span class="kw">=</span> <span class="st">"GERMAPARL"</span>)<span class="kw">[[</span><span class="st">"home"</span>]],
  <span class="kw">s_attribute</span> <span class="kw">=</span> <span class="st">"s"</span>,
  <span class="kw">corpus</span> <span class="kw">=</span> <span class="st">"GERMAPARL"</span>,
  <span class="kw">region_matrix</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="no">df</span>[,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"cpos_left"</span>, <span class="st">"cpos_right"</span>)]),
  <span class="kw">method</span> <span class="kw">=</span> <span class="st">"R"</span>,
  <span class="kw">registry_dir</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/polmineR/man/registry.html">registry</a></span>(<span class="kw">pkg</span> <span class="kw">=</span> <span class="st">"GERMAPARL"</span>),
  <span class="kw">encoding</span> <span class="kw">=</span> <span class="kw pkg">cwbtools</span><span class="kw ns">::</span><span class="fu"><a href="../reference/registry_file.html">registry_file_parse</a></span>(<span class="kw">corpus</span> <span class="kw">=</span> <span class="st">"GERMAPARL"</span>)<span class="kw">[[</span><span class="st">"properties"</span>]]<span class="kw">[[</span><span class="st">"charset"</span>]],
  <span class="kw">delete</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
  <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">TRUE</span>
)</pre></body></html></div>
</div>
<div id="checking-the-result" class="section level2">
<h2 class="hasAnchor">
<a href="#checking-the-result" class="anchor"></a>Checking the result</h2>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">k</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/polmineR/man/kwic.html">kwic</a></span>(<span class="st">"GERMAPARL"</span>, <span class="kw">query</span> <span class="kw">=</span> <span class="st">"Integration"</span>, <span class="kw">left</span> <span class="kw">=</span> <span class="fl">30</span>, <span class="kw">right</span> <span class="kw">=</span> <span class="fl">30</span>, <span class="kw">boundary</span> <span class="kw">=</span> <span class="st">"s"</span>)</pre></body></html></div>
</div>
<div id="next-steps" class="section level2">
<h2 class="hasAnchor">
<a href="#next-steps" class="anchor"></a>Next Steps</h2>
<p>Using the part-of-speech annotation is a basic approach to obtain the data for annotation sentences. An alternative would be to use the NLP annotation machinery of an integrated tool such as Stanford CoreNLP, or OpenNLP. But that’s a different story to be told.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Andreas Blaette.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
