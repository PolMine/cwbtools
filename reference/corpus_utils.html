<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Install and manage corpora. — corpus_install • cwbtools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Install and manage corpora. — corpus_install" />
<meta property="og:description" content="Utility functions to assist the installation and management of indexed CWB
corpora." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cwbtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/europarl.html">Creating a Corpus Data Package: Wrapping Europarl</a>
    </li>
    <li>
      <a href="../articles/sentences.html">How to add a sentence annotation to an indexed corpus</a>
    </li>
    <li>
      <a href="../articles/vignette.html">Introducing 'cwbtools'</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/PolMine/cwbtools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Install and manage corpora.</h1>
    <small class="dont-index">Source: <a href='https://github.com/PolMine/cwbtools/blob/master/R/corpus.R'><code>R/corpus.R</code></a></small>
    <div class="hidden name"><code>corpus_utils.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Utility functions to assist the installation and management of indexed CWB
corpora.</p>
    </div>

    <pre class="usage"><span class='fu'>corpus_install</span><span class='op'>(</span>
  pkg <span class='op'>=</span> <span class='cn'>NULL</span>,
  repo <span class='op'>=</span> <span class='st'>"https://PolMine.github.io/drat/"</span>,
  tarball <span class='op'>=</span> <span class='cn'>NULL</span>,
  doi <span class='op'>=</span> <span class='cn'>NULL</span>,
  lib <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/libPaths.html'>.libPaths</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,
  registry_dir <span class='op'>=</span> <span class='fu'>cwbtools</span><span class='fu'>::</span><span class='fu'><a href='cwb_corpus_dir.html'>cwb_registry_dir</a></span><span class='op'>(</span><span class='op'>)</span>,
  corpus_dir <span class='op'>=</span> <span class='fu'><a href='cwb_corpus_dir.html'>cwb_corpus_dir</a></span><span class='op'>(</span><span class='va'>registry_dir</span><span class='op'>)</span>,
  ask <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  user <span class='op'>=</span> <span class='cn'>NULL</span>,
  password <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='fu'>corpus_packages</span><span class='op'>(</span><span class='op'>)</span>

<span class='fu'>corpus_rename</span><span class='op'>(</span>
  <span class='va'>old</span>,
  <span class='va'>new</span>,
  registry_dir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.getenv.html'>Sys.getenv</a></span><span class='op'>(</span><span class='st'>"CORPUS_REGISTRY"</span><span class='op'>)</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='fu'>corpus_remove</span><span class='op'>(</span><span class='va'>corpus</span>, registry_dir <span class='op'>=</span> <span class='fu'><a href='cwb_corpus_dir.html'>cwb_registry_dir</a></span><span class='op'>(</span><span class='op'>)</span>, ask <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>corpus_as_tarball</span><span class='op'>(</span><span class='va'>corpus</span>, <span class='va'>registry_dir</span>, <span class='va'>data_dir</span>, <span class='va'>tarfile</span>, verbose <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='fu'>corpus_copy</span><span class='op'>(</span>
  <span class='va'>corpus</span>,
  <span class='va'>registry_dir</span>,
  data_dir <span class='op'>=</span> <span class='cn'>NULL</span>,
  registry_dir_new <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/normalizePath.html'>normalizePath</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, winslash <span class='op'>=</span> <span class='st'>"/"</span><span class='op'>)</span>, <span class='st'>"cwb"</span>,
    <span class='st'>"registry"</span>, fsep <span class='op'>=</span> <span class='st'>"/"</span><span class='op'>)</span>,
  data_dir_new <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/normalizePath.html'>normalizePath</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, winslash <span class='op'>=</span> <span class='st'>"/"</span><span class='op'>)</span>, <span class='st'>"cwb"</span>,
    <span class='st'>"indexed_corpora"</span>, <span class='fu'><a href='https://rdrr.io/r/base/chartr.html'>tolower</a></span><span class='op'>(</span><span class='va'>corpus</span><span class='op'>)</span>, fsep <span class='op'>=</span> <span class='st'>"/"</span><span class='op'>)</span>,
  verbose <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span>,
  progress <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='fu'>corpus_recode</span><span class='op'>(</span>
  <span class='va'>corpus</span>,
  registry_dir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.getenv.html'>Sys.getenv</a></span><span class='op'>(</span><span class='st'>"CORPUS_REGISTRY"</span><span class='op'>)</span>,
  data_dir <span class='op'>=</span> <span class='fu'><a href='registry_file_parse.html'>registry_file_parse</a></span><span class='op'>(</span><span class='va'>corpus</span>, <span class='va'>registry_dir</span><span class='op'>)</span><span class='op'>[[</span><span class='st'>"home"</span><span class='op'>]</span><span class='op'>]</span>,
  skip <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span><span class='op'>(</span><span class='op'>)</span>,
  to <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"latin1"</span>, <span class='st'>"UTF-8"</span><span class='op'>)</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>

<span class='fu'>corpus_testload</span><span class='op'>(</span>
  <span class='va'>corpus</span>,
  registry_dir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.getenv.html'>Sys.getenv</a></span><span class='op'>(</span><span class='st'>"CORPUS_REGISTRY"</span><span class='op'>)</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>pkg</th>
      <td><p>Name of the data package.</p></td>
    </tr>
    <tr>
      <th>repo</th>
      <td><p>URL of the repository.</p></td>
    </tr>
    <tr>
      <th>tarball</th>
      <td><p>The URL or local path to a tarball with a CWB indexed corpus.</p></td>
    </tr>
    <tr>
      <th>doi</th>
      <td><p>The DOI (Digital Object Identifier) of a corpus deposited at
Zenodo (e.g. "10.5281/zenodo.3748858".)</p></td>
    </tr>
    <tr>
      <th>lib</th>
      <td><p>Directory for R packages, defaults to <code>.libPaths()[1]</code>.</p></td>
    </tr>
    <tr>
      <th>registry_dir</th>
      <td><p>Directory of registry.</p></td>
    </tr>
    <tr>
      <th>corpus_dir</th>
      <td><p>The directory that contains the data directories of indexed
corpora.</p></td>
    </tr>
    <tr>
      <th>ask</th>
      <td><p>A <code>logical</code> value, whether to ask user for confirmation
before removing a corpus.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical, whether to be verbose.</p></td>
    </tr>
    <tr>
      <th>user</th>
      <td><p>A user name that can be specified to download a corpus from a password protected site.</p></td>
    </tr>
    <tr>
      <th>password</th>
      <td><p>A password that can be specified to download a corpus from a password protected site.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further parameters that will be passed into
<code>install.packages</code>, if argument <code>tarball</code> is <code>NULL</code>, or into
or <code>download.file</code>, if <code>tarball</code> is specified.</p></td>
    </tr>
    <tr>
      <th>old</th>
      <td><p>Name of the (old) corpus.</p></td>
    </tr>
    <tr>
      <th>new</th>
      <td><p>Name of the (new) corpus.</p></td>
    </tr>
    <tr>
      <th>corpus</th>
      <td><p>A CWB corpus.</p></td>
    </tr>
    <tr>
      <th>data_dir</th>
      <td><p>The data directory where the files of the CWB corpus live.</p></td>
    </tr>
    <tr>
      <th>tarfile</th>
      <td><p>Filename of tarball.</p></td>
    </tr>
    <tr>
      <th>registry_dir_new</th>
      <td><p>Target directory with for (new) registry files.</p></td>
    </tr>
    <tr>
      <th>data_dir_new</th>
      <td><p>Target directory for corpus files.</p></td>
    </tr>
    <tr>
      <th>progress</th>
      <td><p>Logical, whether to show a progress bar.</p></td>
    </tr>
    <tr>
      <th>skip</th>
      <td><p>A character vector with s_attributes to skip.</p></td>
    </tr>
    <tr>
      <th>to</th>
      <td><p>Character string describing the target encoding of the corpus.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Logical value <code>TRUE</code> if installation has been successful.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>A CWB corpus consists a set of binary files with corpus data 
  kept together in a data directory, and a registry file, which is a
  plain test file that details the corpus id, corpus properties, 
  structural and positional attributes. The registry file also specifies
  the path to the corpus data directory. Typically, the registry directory
  and a corpus directory with the data directories for individual corpora
  are within one parent folder (which might be called "cwb" by default).
  See the following stylized directory structure.</p>
<pre>
  .
  |- registry/
  |  |- corpus1 
  |  +- corpus2
  |
  + indexed_corpora/
    |- corpus1/
    |  |- file1
    |  |- file2
    |  +- file3
    |
    +- corpus2/
       |- file1
       |- file2
       +- file3
</pre>

<p>The <code>corpus_install</code> function will assist the installation of a
  corpus. The following scenarios are offered:</p><ul>
<li><p>If argument <code>tarball</code> is a local tarball, the tarball will
  be extracted and files will be moved.</p></li>
<li><p>If <code>tarball</code> is a URL, the tarball will be downloaded from
  the online location. It is possible to state user credentials using the
  arguments <code>user</code> and <code>password</code>. Then the aforementioned
  installation (scenario 1) is executed. If argument <code>pkg</code> is the
  name of an installed package, corpus files will be moved into this 
  package.</p></li>
<li><p>If argument <code>doi</code> is Document Object Identifier (DOI), the URL
  from which a corpus tarball can be downloaded is derived from the
  information available at that location. The tarball is downloaded and the
  corpus installed. If argument <code>pkg</code> is defined, files will be moved
  into a R package, the syste registry and corpus directories are used
  otherwise. Note that at this stage, it is assumed that the DOI has been
  awarded by <a href='https://zenodo.org/'>Zenodo</a></p></li>
<li><p>If argument <code>pkg</code> is provided and specifies an R package (and
  <code>tarball</code> is <code>NULL</code>), the corpus package available at a
  CRAN-style repository specified by argument <code>repo</code> will be installed.
  Internally, the <code>install.packages</code> function is called and further
  arguments can be passed into this function call. This can be used to pass
  user credentials, e.g. by adding <code>method = "wget" extra = "--user
  donald --password duck"</code>.</p></li>
</ul><p>If the corpus to be installed is already available, a dialogue will ask the
user whether an existing corpus shall be deleted and installed anew, if
argument <code>ask</code> is <code>TRUE</code>.</p>
<p><code>corpus_packages</code> will detect the packages that include CWB
  corpora. Note that the directory structure of all installed packages is
  evaluated which may be slow on network-mounted file systems.</p>
<p><code>corpus_rename</code> will rename a corpus, affecting the name of the
  registry file, the corpus id, and the name of the directory where data
  files reside.</p>
<p><code>corpus_remove</code> can be used to delete a corpus.</p>
<p><code>corpus_as_tarball</code> will create a tarball (.tar.gz-file) with
  two subdirectories. The 'registry' subdirectory will host the registry file
  for the tarred corpus. The data files will be put in a subdirectory with
  the corpus name in the 'indexed_corpora' subdirectory.</p>
<p><code>corpus_copy</code> will create a copy of a corpus (useful for
  experimental modifications, for instance).</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>For managing registry files, see <code><a href='registry_file_parse.html'>registry_file_parse</a></code>
for switching to a packaged corpus.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>registry_file_new</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/r/base/normalizePath.html'>normalizePath</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, winslash <span class='op'>=</span> <span class='st'>"/"</span><span class='op'>)</span>,
  <span class='st'>"cwb"</span>, <span class='st'>"registry"</span>, <span class='st'>"reuters"</span>, fsep <span class='op'>=</span> <span class='st'>"/"</span>
  <span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/files.html'>file.exists</a></span><span class='op'>(</span><span class='va'>registry_file_new</span><span class='op'>)</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/files.html'>file.remove</a></span><span class='op'>(</span><span class='va'>registry_file_new</span><span class='op'>)</span>
<span class='fu'>corpus_copy</span><span class='op'>(</span>
  corpus <span class='op'>=</span> <span class='st'>"REUTERS"</span>,
  registry_dir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span>package <span class='op'>=</span> <span class='st'>"RcppCWB"</span>, <span class='st'>"extdata"</span>, <span class='st'>"cwb"</span>, <span class='st'>"registry"</span><span class='op'>)</span>,
  data_dir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span>
    package <span class='op'>=</span> <span class='st'>"RcppCWB"</span>,
    <span class='st'>"extdata"</span>, <span class='st'>"cwb"</span>, <span class='st'>"indexed_corpora"</span>, <span class='st'>"reuters"</span>
  <span class='op'>)</span>
<span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/unlink.html'>unlink</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/r/base/normalizePath.html'>normalizePath</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, winslash <span class='op'>=</span> <span class='st'>"/"</span><span class='op'>)</span>,
  <span class='st'>"cwb"</span>, fsep <span class='op'>=</span> <span class='st'>"/"</span><span class='op'>)</span>,
  recursive <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>corpus</span> <span class='op'>&lt;-</span> <span class='st'>"REUTERS"</span>
<span class='va'>pkg</span> <span class='op'>&lt;-</span> <span class='st'>"RcppCWB"</span>
<span class='va'>s_attr</span> <span class='op'>&lt;-</span> <span class='st'>"places"</span>
<span class='va'>Q</span> <span class='op'>&lt;-</span> <span class='st'>'"oil"'</span>

<span class='va'>registry_dir_src</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span>package <span class='op'>=</span> <span class='va'>pkg</span>, <span class='st'>"extdata"</span>, <span class='st'>"cwb"</span>, <span class='st'>"registry"</span><span class='op'>)</span>
<span class='va'>data_dir_src</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span>package <span class='op'>=</span> <span class='va'>pkg</span>, <span class='st'>"extdata"</span>, <span class='st'>"cwb"</span>, <span class='st'>"indexed_corpora"</span>, <span class='fu'><a href='https://rdrr.io/r/base/chartr.html'>tolower</a></span><span class='op'>(</span><span class='va'>corpus</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>registry_dir_tmp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/r/base/normalizePath.html'>normalizePath</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, winslash <span class='op'>=</span> <span class='st'>"/"</span><span class='op'>)</span>,
  <span class='st'>"cwb"</span>, <span class='st'>"registry"</span>, fsep <span class='op'>=</span> <span class='st'>"/"</span>
<span class='op'>)</span>
<span class='va'>registry_file_tmp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='va'>registry_dir_tmp</span>, <span class='fu'><a href='https://rdrr.io/r/base/chartr.html'>tolower</a></span><span class='op'>(</span><span class='va'>corpus</span><span class='op'>)</span>, fsep <span class='op'>=</span> <span class='st'>"/"</span><span class='op'>)</span>
<span class='va'>data_dir_tmp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/r/base/normalizePath.html'>normalizePath</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, winslash <span class='op'>=</span> <span class='st'>"/"</span><span class='op'>)</span>,
  <span class='st'>"cwb"</span>, <span class='st'>"indexed_corpora"</span>, <span class='fu'><a href='https://rdrr.io/r/base/chartr.html'>tolower</a></span><span class='op'>(</span><span class='va'>corpus</span><span class='op'>)</span>, fsep <span class='op'>=</span> <span class='st'>"/"</span>
<span class='op'>)</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/files.html'>file.exists</a></span><span class='op'>(</span><span class='va'>registry_file_tmp</span><span class='op'>)</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/files.html'>file.remove</a></span><span class='op'>(</span><span class='va'>registry_file_tmp</span><span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/files2.html'>dir.exists</a></span><span class='op'>(</span><span class='va'>data_dir_tmp</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
   <span class='fu'><a href='https://rdrr.io/r/base/files2.html'>dir.create</a></span><span class='op'>(</span><span class='va'>data_dir_tmp</span>, recursive <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span><span class='op'>(</span><span class='va'>data_dir_tmp</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>0L</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/base/files.html'>file.remove</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span><span class='op'>(</span><span class='va'>data_dir_tmp</span>, full.names <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'>corpus_copy</span><span class='op'>(</span>
  corpus <span class='op'>=</span> <span class='va'>corpus</span>,
  registry_dir <span class='op'>=</span> <span class='va'>registry_dir_src</span>,
  data_dir <span class='op'>=</span> <span class='va'>data_dir_src</span>,
  registry_dir_new <span class='op'>=</span> <span class='va'>registry_dir_tmp</span>,
  data_dir_new <span class='op'>=</span> <span class='va'>data_dir_tmp</span>
<span class='op'>)</span>

<span class='fu'>RcppCWB</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/RcppCWB/man/cl_charset_name.html'>cl_charset_name</a></span><span class='op'>(</span>corpus <span class='op'>=</span> <span class='va'>corpus</span>, registry <span class='op'>=</span> <span class='va'>registry_dir_tmp</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "latin1"</div><div class='input'>
<span class='fu'>corpus_recode</span><span class='op'>(</span>
  corpus <span class='op'>=</span> <span class='va'>corpus</span>,
  registry_dir <span class='op'>=</span> <span class='va'>registry_dir_tmp</span>,
  data_dir <span class='op'>=</span> <span class='va'>data_dir_tmp</span>,
  to <span class='op'>=</span> <span class='st'>"UTF-8"</span>
<span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Recoding s-attribute: id</span></div><div class='output co'>#&gt; <span class='message'>Recoding s-attribute: topics_cat</span></div><div class='output co'>#&gt; <span class='message'>Recoding s-attribute: places</span></div><div class='output co'>#&gt; <span class='message'>Recoding s-attribute: language</span></div><div class='output co'>#&gt; <span class='message'>Recoding p-attribute: word</span></div><div class='input'>
<span class='fu'>RcppCWB</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/RcppCWB/man/cl_delete_corpus.html'>cl_delete_corpus</a></span><span class='op'>(</span>corpus <span class='op'>=</span> <span class='va'>corpus</span>, registry <span class='op'>=</span> <span class='va'>registry_dir_tmp</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Corpus to delete (ID): REUTERS
#&gt; Corpus name: Reuters Sample Corpus
#&gt; Number of loads before reset: 1
#&gt; Number of loads resetted: 1</div><div class='output co'>#&gt; [1] 0</div><div class='input'><span class='fu'>RcppCWB</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/RcppCWB/man/cqp_initialize.html'>cqp_initialize</a></span><span class='op'>(</span><span class='va'>registry_dir_tmp</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: CQP has already been initialized. Re-initialization is not possible. Only resetting registry.</span></div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='fu'>RcppCWB</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/RcppCWB/man/cl_charset_name.html'>cl_charset_name</a></span><span class='op'>(</span>corpus <span class='op'>=</span> <span class='va'>corpus</span>, registry <span class='op'>=</span> <span class='va'>registry_dir_tmp</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "utf8"</div><div class='input'>
<span class='va'>n_strucs</span> <span class='op'>&lt;-</span> <span class='fu'>RcppCWB</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/RcppCWB/man/cl_attribute_size.html'>cl_attribute_size</a></span><span class='op'>(</span>
  corpus <span class='op'>=</span> <span class='va'>corpus</span>, attribute <span class='op'>=</span> <span class='va'>s_attr</span>, attribute_type <span class='op'>=</span> <span class='st'>"s"</span>, registry <span class='op'>=</span> <span class='va'>registry_dir_tmp</span>
<span class='op'>)</span>
<span class='va'>strucs</span> <span class='op'>&lt;-</span> <span class='fl'>0L</span><span class='op'>:</span><span class='op'>(</span><span class='va'>n_strucs</span> <span class='op'>-</span> <span class='fl'>1L</span><span class='op'>)</span>
<span class='va'>struc_values</span> <span class='op'>&lt;-</span> <span class='fu'>RcppCWB</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/RcppCWB/man/s_attributes.html'>cl_struc2str</a></span><span class='op'>(</span>
  corpus <span class='op'>=</span> <span class='va'>corpus</span>, s_attribute <span class='op'>=</span> <span class='va'>s_attr</span>, struc <span class='op'>=</span> <span class='va'>strucs</span>, registry <span class='op'>=</span> <span class='va'>registry_dir_tmp</span>
<span class='op'>)</span>
<span class='va'>speakers</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/duplicated.html'>unique</a></span><span class='op'>(</span><span class='va'>struc_values</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/Sys.setenv.html'>Sys.setenv</a></span><span class='op'>(</span><span class='st'>"CORPUS_REGISTRY"</span> <span class='op'>=</span> <span class='va'>registry_dir_tmp</span><span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='fu'>RcppCWB</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/RcppCWB/man/cqp_initialize.html'>cqp_is_initialized</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='fu'>RcppCWB</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/RcppCWB/man/cqp_initialize.html'>cqp_reset_registry</a></span><span class='op'>(</span><span class='op'>)</span> <span class='kw'>else</span> <span class='fu'>RcppCWB</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/RcppCWB/man/cqp_initialize.html'>cqp_initialize</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='fu'>RcppCWB</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/RcppCWB/man/cqp_query.html'>cqp_query</a></span><span class='op'>(</span>corpus <span class='op'>=</span> <span class='va'>corpus</span>, query <span class='op'>=</span> <span class='va'>Q</span><span class='op'>)</span>
</div><div class='output co'>#&gt; NULL</div><div class='input'><span class='va'>cpos</span> <span class='op'>&lt;-</span> <span class='fu'>RcppCWB</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/RcppCWB/man/cqp_query.html'>cqp_dump_subcorpus</a></span><span class='op'>(</span>corpus <span class='op'>=</span> <span class='va'>corpus</span><span class='op'>)</span>
<span class='va'>ids</span> <span class='op'>&lt;-</span> <span class='fu'>RcppCWB</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/RcppCWB/man/p_attributes.html'>cl_cpos2id</a></span><span class='op'>(</span>
  corpus <span class='op'>=</span> <span class='va'>corpus</span>, p_attribute <span class='op'>=</span> <span class='st'>"word"</span>, registry <span class='op'>=</span> <span class='va'>registry_dir_tmp</span>, cpos <span class='op'>=</span> <span class='va'>cpos</span>
<span class='op'>)</span>
<span class='va'>str</span> <span class='op'>&lt;-</span> <span class='fu'>RcppCWB</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/RcppCWB/man/p_attributes.html'>cl_id2str</a></span><span class='op'>(</span>
  corpus <span class='op'>=</span> <span class='va'>corpus</span>, p_attribute <span class='op'>=</span> <span class='st'>"word"</span>, registry <span class='op'>=</span> <span class='va'>registry_dir_tmp</span>, id <span class='op'>=</span> <span class='va'>ids</span>
<span class='op'>)</span>
<span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/duplicated.html'>unique</a></span><span class='op'>(</span><span class='va'>str</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "oil"</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/unlink.html'>unlink</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/normalizePath.html'>normalizePath</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, winslash <span class='op'>=</span> <span class='st'>"/"</span><span class='op'>)</span>, <span class='st'>"cwb"</span>, fsep <span class='op'>=</span> <span class='st'>"/"</span><span class='op'>)</span>, recursive <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andreas Blaette.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


