<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Install and manage corpora. — corpus_install • cwbtools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Install and manage corpora. — corpus_install"><meta property="og:description" content="Utility functions to assist the installation and management of indexed CWB
corpora."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cwbtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/opennlp.html">CWB corpora and openNLP</a>
    </li>
    <li>
      <a href="../articles/sentences.html">How to add a sentence annotation to an indexed corpus</a>
    </li>
    <li>
      <a href="../articles/vignette.html">Introducing 'cwbtools'</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/PolMine/cwbtools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Install and manage corpora.</h1>
    <small class="dont-index">Source: <a href="https://github.com/PolMine/cwbtools/blob/HEAD/R/corpus.R" class="external-link"><code>R/corpus.R</code></a></small>
    <div class="hidden name"><code>corpus_utils.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Utility functions to assist the installation and management of indexed CWB
corpora.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">corpus_install</span><span class="op">(</span></span>
<span>  pkg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  repo <span class="op">=</span> <span class="st">"https://PolMine.github.io/drat/"</span>,</span>
<span>  tarball <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  doi <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  checksum <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lib <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/libPaths.html" class="external-link">.libPaths</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  <span class="va">registry_dir</span>,</span>
<span>  <span class="va">corpus_dir</span>,</span>
<span>  ask <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  load <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  user <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  password <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">corpus_packages</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">corpus_rename</span><span class="op">(</span></span>
<span>  <span class="va">old</span>,</span>
<span>  <span class="va">new</span>,</span>
<span>  registry_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"CORPUS_REGISTRY"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">corpus_remove</span><span class="op">(</span><span class="va">corpus</span>, <span class="va">registry_dir</span>, ask <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">corpus_as_tarball</span><span class="op">(</span><span class="va">corpus</span>, <span class="va">registry_dir</span>, <span class="va">data_dir</span>, <span class="va">tarfile</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">corpus_copy</span><span class="op">(</span></span>
<span>  <span class="va">corpus</span>,</span>
<span>  <span class="va">registry_dir</span>,</span>
<span>  data_dir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  registry_dir_new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/normalizePath.html" class="external-link">normalizePath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, winslash <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>, <span class="st">"cwb"</span>,</span>
<span>    <span class="st">"registry"</span>, fsep <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>,</span>
<span>  data_dir_new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/normalizePath.html" class="external-link">normalizePath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, winslash <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>, <span class="st">"cwb"</span>,</span>
<span>    <span class="st">"indexed_corpora"</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">corpus</span><span class="op">)</span>, fsep <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>,</span>
<span>  remove <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">corpus_recode</span><span class="op">(</span></span>
<span>  <span class="va">corpus</span>,</span>
<span>  registry_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"CORPUS_REGISTRY"</span><span class="op">)</span>,</span>
<span>  data_dir <span class="op">=</span> <span class="fu"><a href="registry_file.html">registry_file_parse</a></span><span class="op">(</span><span class="va">corpus</span>, <span class="va">registry_dir</span><span class="op">)</span><span class="op">[[</span><span class="st">"home"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  skip <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"latin1"</span>, <span class="st">"UTF-8"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">corpus_testload</span><span class="op">(</span></span>
<span>  <span class="va">corpus</span>,</span>
<span>  registry_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"CORPUS_REGISTRY"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">corpus_get_version</span><span class="op">(</span><span class="va">corpus</span>, registry_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"CORPUS_REGISTRY"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>pkg</dt>
<dd><p>Name of the data package.</p></dd>


<dt>repo</dt>
<dd><p>URL of the repository.</p></dd>


<dt>tarball</dt>
<dd><p>URL,  S3-URI or local filename of a tarball with a CWB indexed
corpus. If <code>NULL</code> (default) and argument <code>doi</code> is stated, the
whereabouts of a corpus tarball will be derived from DOI.</p></dd>


<dt>doi</dt>
<dd><p>The DOI (Digital Object Identifier) of a corpus deposited at
Zenodo (e.g. "10.5281/zenodo.3748858".)</p></dd>


<dt>checksum</dt>
<dd><p>A length-one <code>character</code> vector with a MD5 checksum to
check for the integrity of a downloaded tarball. If the tarball is
downloaded from Zenodo by stating a DOI (argument <code>doi</code>), the checksum
included in the metadata for the record is used for the check.</p></dd>


<dt>lib</dt>
<dd><p>Directory for R packages, defaults to <code>.libPaths()[1]</code>.</p></dd>


<dt>registry_dir</dt>
<dd><p>The corpus registry directory. If missing, the result of
<code><a href="directories.html">cwb_registry_dir()</a></code>.</p></dd>


<dt>corpus_dir</dt>
<dd><p>The directory that contains the data directories of indexed
corpora. If missing, the value of <code><a href="directories.html">cwb_corpus_dir()</a></code> will be used.</p></dd>


<dt>ask</dt>
<dd><p>A <code>logical</code> value, whether to ask user for confirmation before
removing a corpus.</p></dd>


<dt>load</dt>
<dd><p>A <code>logical</code> value, whether to load corpus after installation.</p></dd>


<dt>verbose</dt>
<dd><p>Logical, whether to be verbose.</p></dd>


<dt>user</dt>
<dd><p>A user name that can be specified to download a corpus from a password protected site.</p></dd>


<dt>password</dt>
<dd><p>A password that can be specified to download a corpus from a password protected site.</p></dd>


<dt>...</dt>
<dd><p>Further parameters that will be passed into
<code>install.packages</code>, if argument <code>tarball</code> is <code>NULL</code>, or into
or <code>download.file</code>, if <code>tarball</code> is specified.</p></dd>


<dt>old</dt>
<dd><p>Name of the (old) corpus.</p></dd>


<dt>new</dt>
<dd><p>Name of the (new) corpus.</p></dd>


<dt>corpus</dt>
<dd><p>The ID of a CWB indexed corpus (in upper case).</p></dd>


<dt>data_dir</dt>
<dd><p>The data directory where the files of the CWB corpus live.</p></dd>


<dt>tarfile</dt>
<dd><p>Filename of tarball.</p></dd>


<dt>registry_dir_new</dt>
<dd><p>Target directory with for (new) registry files.</p></dd>


<dt>data_dir_new</dt>
<dd><p>Target directory for corpus files.</p></dd>


<dt>remove</dt>
<dd><p>A <code>logical</code> value, whether to remove orginal files after
having created the copy.</p></dd>


<dt>progress</dt>
<dd><p>Logical, whether to show a progress bar.</p></dd>


<dt>skip</dt>
<dd><p>A character vector with s_attributes to skip.</p></dd>


<dt>to</dt>
<dd><p>Character string describing the target encoding of the corpus.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Logical value <code>TRUE</code> if installation has been successful, or <code>FALSE</code> if not.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>A CWB corpus consists a set of binary files with corpus data
kept together in a data directory, and a registry file, which is a
plain test file that details the corpus id, corpus properties,
structural and positional attributes. The registry file also specifies
the path to the corpus data directory. Typically, the registry directory
and a corpus directory with the data directories for individual corpora
are within one parent folder (which might be called "cwb" by default).
See the following stylized directory structure.</p>
<div class="sourceCode"><pre><code>
  .
  |- registry/
  |  |- corpus1
  |  +- corpus2
  |
  + indexed_corpora/
    |- corpus1/
    |  |- file1
    |  |- file2
    |  +- file3
    |
    +- corpus2/
       |- file1
       |- file2
       +- file3
</code></pre></div>

<p>The <code>corpus_install</code> function will assist the installation of a
corpus. The following scenarios are offered:</p><ul><li><p>If argument <code>tarball</code> is a local tarball, the tarball will
be extracted and files will be moved.</p></li>
<li><p>If <code>tarball</code> is a URL, the tarball will be downloaded from
the online location. It is possible to state user credentials using the
arguments <code>user</code> and <code>password</code>. Then the aforementioned
installation (scenario 1) is executed. If argument <code>pkg</code> is the
name of an installed package, corpus files will be moved into this
package.</p></li>
<li><p>If argument <code>doi</code> is Document Object Identifier (DOI), the URL
from which a corpus tarball can be downloaded is derived from the
information available at that location. The tarball is downloaded and the
corpus installed. If argument <code>pkg</code> is defined, files will be moved
into a R package, the syste registry and corpus directories are used
otherwise. Note that at this stage, it is assumed that the DOI has been
awarded by <a href="https://zenodo.org/" class="external-link">Zenodo</a></p></li>
<li><p>If argument <code>pkg</code> is provided and specifies an R package (and
<code>tarball</code> is <code>NULL</code>), the corpus package available at a
CRAN-style repository specified by argument <code>repo</code> will be installed.
Internally, the <code>install.packages</code> function is called and further
arguments can be passed into this function call. This can be used to pass
user credentials, e.g. by adding <code>method = "wget" extra = "--user
  donald --password duck"</code>.</p></li>
</ul><p>If the corpus to be installed is already available, a dialogue will ask the
user whether an existing corpus shall be deleted and installed anew, if
argument <code>ask</code> is <code>TRUE</code>.</p>
<p><code>corpus_packages</code> will detect the packages that include CWB
corpora. Note that the directory structure of all installed packages is
evaluated which may be slow on network-mounted file systems.</p>
<p><code>corpus_rename</code> will rename a corpus, affecting the name of the
registry file, the corpus id, and the name of the directory where data
files reside.</p>
<p><code>corpus_remove()</code> can be used to delete a corpus.</p>
<p><code>corpus_as_tarball</code> will create a tarball (.tar.gz-file) with
two subdirectories. The 'registry' subdirectory will host the registry file
for the tarred corpus. The data files will be put in a subdirectory with
the corpus name in the 'indexed_corpora' subdirectory.</p>
<p><code>corpus_copy</code> will create a copy of a corpus (useful for
experimental modifications, for instance).</p>
<p><code>corpus_get_version</code> parses the registry file and derives the
corpus version number from the corpus properties. The return value is a
<code>numeric_version</code> class object. The corpus version is expected to follow
semantic versioning (three digits, e.g. '0.8.1'). If the corpus version
has another format or if it is not available, the return value is <code>NA</code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>For managing registry files, see <code><a href="registry_file.html">registry_file_parse</a></code>
for switching to a packaged corpus.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">registry_file_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/normalizePath.html" class="external-link">normalizePath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, winslash <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"cwb"</span>, <span class="st">"registry"</span>, <span class="st">"reuters"</span>, fsep <span class="op">=</span> <span class="st">"/"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">registry_file_new</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="va">registry_file_new</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">corpus_copy</span><span class="op">(</span></span></span>
<span class="r-in"><span>  corpus <span class="op">=</span> <span class="st">"REUTERS"</span>,</span></span>
<span class="r-in"><span>  registry_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"RcppCWB"</span>, <span class="st">"extdata"</span>, <span class="st">"cwb"</span>, <span class="st">"registry"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  data_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    package <span class="op">=</span> <span class="st">"RcppCWB"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"extdata"</span>, <span class="st">"cwb"</span>, <span class="st">"indexed_corpora"</span>, <span class="st">"reuters"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/normalizePath.html" class="external-link">normalizePath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, winslash <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"cwb"</span>, fsep <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">corpus</span> <span class="op">&lt;-</span> <span class="st">"REUTERS"</span></span></span>
<span class="r-in"><span><span class="va">pkg</span> <span class="op">&lt;-</span> <span class="st">"RcppCWB"</span></span></span>
<span class="r-in"><span><span class="va">s_attr</span> <span class="op">&lt;-</span> <span class="st">"places"</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="st">'"oil"'</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">registry_dir_src</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="va">pkg</span>, <span class="st">"extdata"</span>, <span class="st">"cwb"</span>, <span class="st">"registry"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data_dir_src</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="va">pkg</span>, <span class="st">"extdata"</span>, <span class="st">"cwb"</span>, <span class="st">"indexed_corpora"</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">corpus</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">registry_dir_tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/normalizePath.html" class="external-link">normalizePath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, winslash <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"cwb"</span>, <span class="st">"registry"</span>, fsep <span class="op">=</span> <span class="st">"/"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">registry_file_tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">registry_dir_tmp</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">corpus</span><span class="op">)</span>, fsep <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data_dir_tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/normalizePath.html" class="external-link">normalizePath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, winslash <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"cwb"</span>, <span class="st">"indexed_corpora"</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">corpus</span><span class="op">)</span>, fsep <span class="op">=</span> <span class="st">"/"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">registry_file_tmp</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="va">registry_file_tmp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="va">data_dir_tmp</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">data_dir_tmp</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">data_dir_tmp</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0L</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.remove</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">data_dir_tmp</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">corpus_copy</span><span class="op">(</span></span></span>
<span class="r-in"><span>  corpus <span class="op">=</span> <span class="va">corpus</span>,</span></span>
<span class="r-in"><span>  registry_dir <span class="op">=</span> <span class="va">registry_dir_src</span>,</span></span>
<span class="r-in"><span>  data_dir <span class="op">=</span> <span class="va">data_dir_src</span>,</span></span>
<span class="r-in"><span>  registry_dir_new <span class="op">=</span> <span class="va">registry_dir_tmp</span>,</span></span>
<span class="r-in"><span>  data_dir_new <span class="op">=</span> <span class="va">data_dir_tmp</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">RcppCWB</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RcppCWB/man/cl_charset_name.html" class="external-link">cl_charset_name</a></span><span class="op">(</span>corpus <span class="op">=</span> <span class="va">corpus</span>, registry <span class="op">=</span> <span class="va">registry_dir_tmp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "latin1"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">corpus_recode</span><span class="op">(</span></span></span>
<span class="r-in"><span>  corpus <span class="op">=</span> <span class="va">corpus</span>,</span></span>
<span class="r-in"><span>  registry_dir <span class="op">=</span> <span class="va">registry_dir_tmp</span>,</span></span>
<span class="r-in"><span>  data_dir <span class="op">=</span> <span class="va">data_dir_tmp</span>,</span></span>
<span class="r-in"><span>  to <span class="op">=</span> <span class="st">"UTF-8"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Recoding s-attribute: id</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Recoding s-attribute: topics_cat</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Recoding s-attribute: places</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Recoding s-attribute: language</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Recoding p-attribute: word</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">RcppCWB</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RcppCWB/man/cl_delete_corpus.html" class="external-link">cl_delete_corpus</a></span><span class="op">(</span>corpus <span class="op">=</span> <span class="va">corpus</span>, registry <span class="op">=</span> <span class="va">registry_dir_tmp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu">RcppCWB</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RcppCWB/man/cqp_initialize.html" class="external-link">cqp_initialize</a></span><span class="op">(</span><span class="va">registry_dir_tmp</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>CQP has already been initialized. Re-initialization is not possible. Only resetting registry.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu">RcppCWB</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RcppCWB/man/cl_charset_name.html" class="external-link">cl_charset_name</a></span><span class="op">(</span>corpus <span class="op">=</span> <span class="va">corpus</span>, registry <span class="op">=</span> <span class="va">registry_dir_tmp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "utf8"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n_strucs</span> <span class="op">&lt;-</span> <span class="fu">RcppCWB</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RcppCWB/man/cl_attribute_size.html" class="external-link">cl_attribute_size</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  corpus <span class="op">=</span> <span class="va">corpus</span>, attribute <span class="op">=</span> <span class="va">s_attr</span>, attribute_type <span class="op">=</span> <span class="st">"s"</span>, registry <span class="op">=</span> <span class="va">registry_dir_tmp</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">strucs</span> <span class="op">&lt;-</span> <span class="fl">0L</span><span class="op">:</span><span class="op">(</span><span class="va">n_strucs</span> <span class="op">-</span> <span class="fl">1L</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">struc_values</span> <span class="op">&lt;-</span> <span class="fu">RcppCWB</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RcppCWB/man/s_attributes.html" class="external-link">cl_struc2str</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  corpus <span class="op">=</span> <span class="va">corpus</span>, s_attribute <span class="op">=</span> <span class="va">s_attr</span>, struc <span class="op">=</span> <span class="va">strucs</span>, registry <span class="op">=</span> <span class="va">registry_dir_tmp</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">speakers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">struc_values</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span><span class="st">"CORPUS_REGISTRY"</span> <span class="op">=</span> <span class="va">registry_dir_tmp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu">RcppCWB</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RcppCWB/man/cqp_initialize.html" class="external-link">cqp_is_initialized</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="fu">RcppCWB</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RcppCWB/man/cqp_initialize.html" class="external-link">cqp_reset_registry</a></span><span class="op">(</span><span class="op">)</span> <span class="kw">else</span> <span class="fu">RcppCWB</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RcppCWB/man/cqp_initialize.html" class="external-link">cqp_initialize</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu">RcppCWB</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RcppCWB/man/cqp_query.html" class="external-link">cqp_query</a></span><span class="op">(</span>corpus <span class="op">=</span> <span class="va">corpus</span>, query <span class="op">=</span> <span class="va">Q</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;pointer: 0x7fac0f0f3e20&gt;</span>
<span class="r-in"><span><span class="va">cpos</span> <span class="op">&lt;-</span> <span class="fu">RcppCWB</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RcppCWB/man/cqp_query.html" class="external-link">cqp_dump_subcorpus</a></span><span class="op">(</span>corpus <span class="op">=</span> <span class="va">corpus</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu">RcppCWB</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RcppCWB/man/p_attributes.html" class="external-link">cl_cpos2id</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  corpus <span class="op">=</span> <span class="va">corpus</span>, p_attribute <span class="op">=</span> <span class="st">"word"</span>, registry <span class="op">=</span> <span class="va">registry_dir_tmp</span>, cpos <span class="op">=</span> <span class="va">cpos</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">str</span> <span class="op">&lt;-</span> <span class="fu">RcppCWB</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RcppCWB/man/p_attributes.html" class="external-link">cl_id2str</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  corpus <span class="op">=</span> <span class="va">corpus</span>, p_attribute <span class="op">=</span> <span class="st">"word"</span>, registry <span class="op">=</span> <span class="va">registry_dir_tmp</span>, id <span class="op">=</span> <span class="va">ids</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">str</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "oil"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/normalizePath.html" class="external-link">normalizePath</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, winslash <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>, <span class="st">"cwb"</span>, fsep <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Andreas Blaette, Christoph Leonhardt.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

